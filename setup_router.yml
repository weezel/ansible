---
# Usage:
#   ansible-playbook -i 192.168.1.1, setup_router.yml -C
# Needed pre-steps
# 1. Configure doas.conf
# 2. Configure /etc/installurl
# 3. Install python 3.x on the target machine

- hosts: all
  vars_files:
    - vars/network.yml
    - vars/packages.yml
    - vars/openbsd.yml
    - vars/user.yml
    - vars/vault/{{ dst_host_name }}.yml
  vars:
    - server_install: true
    - ip_stub: "192.168.222."
    - network:
        - domain_name: "local.lan"

  roles:
    - { role: default_packages, tags: packages }
    - { role: dotconfigs, tags: configs }
    - { role: network/router, tags: router }
    - { role: dhcpd, tags: dhcpd }
    - { role: unbound, tags: dns }
    - { role: network/firewall, tags: pf }

